<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Three Tribes Chronicle</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="game-graphics.css">
    <link rel="stylesheet" href="inventory.css">
</head>
<body>
    <div id="app">
        <!-- Start Screen -->
        <div id="start-screen" class="screen">
            <div class="container">
                <h1 class="title">üåç Three Tribes Chronicle</h1>
                <p class="subtitle">A text-driven RPG with tribal simulation</p>
                
                <div class="start-form">
                    <input type="text" id="player-name" placeholder="Enter your name" value="Aro">
                    <select id="tribe-select">
                        <option value="Stonefang">Stonefang - Earth-bound warriors</option>
                        <option value="Windveil">Windveil - Agile hunters</option>
                        <option value="Emberroot">Emberroot - Scholars and mystics</option>
                    </select>
                    <button id="start-new-game" class="btn btn-primary">Start New Game</button>
                    <button id="load-game-btn" class="btn btn-secondary">Load Game</button>
                </div>
            </div>
        </div>

        <!-- Load Game Screen -->
        <div id="load-screen" class="screen">
            <div class="container">
                <h2>Load Game</h2>
                <div id="saves-list"></div>
                <button id="back-to-start" class="btn btn-secondary">Back</button>
            </div>
        </div>

        <!-- Game Screen -->
        <div id="game-screen" class="screen">
            <div class="game-container">
                <div class="game-layout">
                    <!-- Left Panel - Character, Equipment & Inventory -->
                    <aside class="left-panel">
                        <!-- Player Status -->
                        <section class="card">
                            <h2>üìä Character</h2>
                            <div id="player-status"></div>
                        </section>

                        <!-- Toggle Button for Tribe/World/NPCs Panel -->
                        <button id="tribe-info-toggle" class="btn btn-secondary btn-toggle">
                            <span class="toggle-icon">üìã</span>
                            <span class="toggle-text">Tribe Info</span>
                        </button>

                        <!-- Combined Tribe/World/NPCs Panel (Hidden by default) -->
                        <section class="card tribe-info-panel" id="tribe-info-panel" style="display: none;">
                            <div class="tabs-container">
                                <div class="tabs-header">
                                    <button class="tab-btn active" data-tab="tribe">üèõÔ∏è Tribe</button>
                                    <button class="tab-btn" data-tab="world">üåç World</button>
                                    <button class="tab-btn" data-tab="members">üë• Members</button>
                                </div>
                                <div class="tabs-content">
                                    <div class="tab-pane active" id="tab-tribe">
                                        <h3><span id="tribe-name">Stonefang</span> Tribe</h3>
                                        <div id="tribe-status"></div>
                                    </div>
                                    <div class="tab-pane" id="tab-world">
                                        <h3>World State</h3>
                                        <div id="world-status"></div>
                                    </div>
                                    <div class="tab-pane" id="tab-members">
                                        <h3>Tribal Members</h3>
                                        <div id="npcs-list"></div>
                                    </div>
                                </div>
                            </div>
                        </section>

                        
                        <!-- Context Menu -->
                        <div id="context-menu" class="context-menu">
                            <div class="context-menu-item" data-action="equip">
                                <span class="context-icon">‚öîÔ∏è</span>
                                <span class="context-text">Equip</span>
                            </div>
                            <div class="context-menu-item" data-action="use">
                                <span class="context-icon">üíä</span>
                                <span class="context-text">Use</span>
                            </div>
                            <div class="context-menu-item" data-action="sell">
                                <span class="context-icon">üí∞</span>
                                <span class="context-text">Sell</span>
                            </div>
                            <div class="context-menu-item" data-action="unequip" style="display: none;">
                                <span class="context-icon">üì¶</span>
                                <span class="context-text">Unequip</span>
                            </div>
                            <div class="context-menu-divider"></div>
                            <div class="context-menu-item" data-action="info">
                                <span class="context-icon">‚ÑπÔ∏è</span>
                                <span class="context-text">Info</span>
                            </div>
                        </div>
                    </aside>

                    <!-- Main Content -->
                    <main class="main-content">
                        <!-- Top Row: Inventory/Equipment Focus and Actions -->
                        <div class="top-row">
                            <!-- Inventory & Equipment Section (Prominent) -->
                            <section class="card inventory-main-section">
                                <h2>üéí Inventory & Equipment</h2>
                                <div class="inventory-main-content">
                                    <!-- Equipment Grid (Top) -->
                                    <div class="equipment-main-grid">
                                        <div class="equipment-slot-main" data-slot="weapon" title="Weapon" draggable="false">
                                            <div class="slot-label-main">‚öîÔ∏è</div>
                                            <div class="slot-item-main" id="equipped-weapon-main"></div>
                                        </div>
                                        <div class="equipment-slot-main" data-slot="armor" title="Armor" draggable="false">
                                            <div class="slot-label-main">üõ°Ô∏è</div>
                                            <div class="slot-item-main" id="equipped-armor-main"></div>
                                        </div>
                                        <div class="equipment-slot-main" data-slot="accessory1" title="Accessory 1" draggable="false">
                                            <div class="slot-label-main">üíç</div>
                                            <div class="slot-item-main" id="equipped-accessory1-main"></div>
                                        </div>
                                        <div class="equipment-slot-main" data-slot="accessory2" title="Accessory 2" draggable="false">
                                            <div class="slot-label-main">üíç</div>
                                            <div class="slot-item-main" id="equipped-accessory2-main"></div>
                                        </div>
                                        <div class="equipment-slot-main" data-slot="accessory3" title="Accessory 3" draggable="false">
                                            <div class="slot-label-main">üíç</div>
                                            <div class="slot-item-main" id="equipped-accessory3-main"></div>
                                        </div>
                                    </div>
                                    
                                    <!-- Inventory Grid (Bottom) -->
                                    <div class="inventory-main-header">
                                        <h3>Bag <span id="bag-count-main">(0/50)</span></h3>
                                        <div class="inventory-main-controls">
                                            <select id="inventory-filter-main" class="inventory-filter">
                                                <option value="all">All</option>
                                                <option value="weapon">Weapons</option>
                                                <option value="armor">Armor</option>
                                                <option value="accessory">Accessories</option>
                                                <option value="consumable">Consumables</option>
                                                <option value="material">Materials</option>
                                            </select>
                                            <button id="sort-type-btn-main" class="btn-sort-type" title="Sort by Type">üîÄ</button>
                                        </div>
                                    </div>
                                    <div class="bag-grid-main" id="bag-grid-main"></div>
                                </div>
                            </section>

                            <!-- Actions -->
                            <section class="card actions-card">
                                <!-- Floating Status Bar -->
                                <div class="status-bar-floating">
                                    <div class="status-group">
                                        <span class="status-label">Day</span>
                                        <span class="status-value" id="current-day">1</span>
                                    </div>
                                    <div class="status-group">
                                        <span class="status-icon">‚ö°</span>
                                        <span class="status-value" id="stamina">5</span>
                                        <span class="status-separator">/</span>
                                        <span class="status-value" id="max-stamina">5</span>
                                    </div>
                                    <div class="status-group">
                                        <span class="status-icon">‚ù§Ô∏è</span>
                                        <span class="status-value" id="health">100</span>
                                        <span class="status-separator">/</span>
                                        <span class="status-value" id="max-health">100</span>
                                    </div>
                                    <div class="status-group status-actions">
                                        <a href="npc-manager.html" class="status-link" title="Manage NPCs">üë•</a>
                                        <a href="game-master.html" class="status-link" title="Game Master">üéÆ</a>
                                    </div>
                                </div>
                                
                                <!-- Enemy Encounter Window (Top) -->
                                <div class="encounter-window" id="encounter-window">
                                    <div class="encounter-placeholder">
                                        <span class="encounter-icon">‚öîÔ∏è</span>
                                        <span class="encounter-text">No encounter</span>
                                    </div>
                                </div>
                                
                                <!-- Action Buttons (Bottom) -->
                                <div class="actions-section">
                                    <h2>üìã Actions</h2>
                                    <div class="actions-grid-compact">
                                        <button class="action-btn-compact" data-action="farm" data-stamina="1" title="Farm - Cost: 1 Stamina">
                                            <span class="icon">üåæ</span>
                                            <span class="label">Farm</span>
                                            <span class="stamina-cost">‚ö°1</span>
                                        </button>
                                        <button class="action-btn-compact" data-action="gather" data-stamina="1" title="Gather - Cost: 1 Stamina">
                                            <span class="icon">üåø</span>
                                            <span class="label">Gather</span>
                                            <span class="stamina-cost">‚ö°1</span>
                                        </button>
                                        <button class="action-btn-compact" data-action="trade" data-stamina="1" title="Trade - Cost: 1 Stamina">
                                            <span class="icon">üí∞</span>
                                            <span class="label">Trade</span>
                                            <span class="stamina-cost">‚ö°1</span>
                                        </button>
                                        <button class="action-btn-compact" data-action="hunt" data-stamina="2" title="Hunt - Cost: 2 Stamina">
                                            <span class="icon">üèπ</span>
                                            <span class="label">Hunt</span>
                                            <span class="stamina-cost">‚ö°2</span>
                                        </button>
                                        <button class="action-btn-compact" data-action="explore" data-stamina="2" title="Explore - Cost: 2 Stamina">
                                            <span class="icon">üó∫Ô∏è</span>
                                            <span class="label">Explore</span>
                                            <span class="stamina-cost">‚ö°2</span>
                                        </button>
                                    </div>
                                    <div class="action-buttons-compact">
                                        <button id="end-day-btn" class="btn btn-primary btn-compact">üåô End Day</button>
                                    </div>
                                </div>
                            </section>
                        </div>

                        <!-- Messages/Events -->
                        <section class="card messages-card">
                            <h2>üìú Events & Messages</h2>
                            <div id="messages" class="messages"></div>
                        </section>
                    </main>
                </div>
            </div>
        </div>

        <!-- NPC Selection Modal -->
        <div id="npc-modal" class="modal">
            <div class="modal-content">
                <h2>Choose an NPC to Visit</h2>
                <div id="npc-selection"></div>
                <button class="btn btn-secondary" id="close-npc-modal">Cancel</button>
            </div>
        </div>

        <!-- Combat Window -->
        <div id="combat-window" class="combat-window">
            <div class="combat-container">
                <div class="combat-header">
                    <h2>‚öîÔ∏è Combat Encounter</h2>
                </div>
                
                <div class="combat-battlefield">
                    <!-- Enemy Side -->
                    <div class="combat-side enemy-side">
                        <div class="combat-character-card enemy-card">
                            <div class="character-avatar enemy-avatar">
                                <span id="enemy-emoji">üê∫</span>
                            </div>
                            <div class="character-info">
                                <h3 id="enemy-name">Wild Animal</h3>
                                <div class="level-badge" id="enemy-level">Lv. 1</div>
                            </div>
                            <div class="health-bar-container">
                                <div class="health-bar-label">
                                    <span>Health</span>
                                    <span id="enemy-health-text">100/100</span>
                                </div>
                                <div class="health-bar">
                                    <div class="health-bar-fill enemy-health" id="enemy-health-bar" style="width: 100%"></div>
                                </div>
                            </div>
                            <div class="stat-grid" id="enemy-stats">
                                <div class="stat-item">
                                    <span class="stat-label">STR</span>
                                    <span class="stat-value" id="enemy-str">0</span>
                                </div>
                                <div class="stat-item">
                                    <span class="stat-label">DEX</span>
                                    <span class="stat-value" id="enemy-dex">0</span>
                                </div>
                                <div class="stat-item">
                                    <span class="stat-label">DMG</span>
                                    <span class="stat-value" id="enemy-damage">0</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- VS Divider -->
                    <div class="combat-vs">
                        <div class="vs-line"></div>
                        <div class="vs-text">VS</div>
                        <div class="vs-line"></div>
                    </div>
                    
                    <!-- Player Side -->
                    <div class="combat-side player-side">
                        <div class="combat-character-card player-card">
                            <div class="character-avatar player-avatar">
                                <span>‚öîÔ∏è</span>
                            </div>
                            <div class="character-info">
                                <h3 id="player-combat-name">Player</h3>
                                <div class="level-badge" id="player-combat-level">Lv. 1</div>
                            </div>
                            <div class="health-bar-container">
                                <div class="health-bar-label">
                                    <span>Health</span>
                                    <span id="player-health-text">100/100</span>
                                </div>
                                <div class="health-bar">
                                    <div class="health-bar-fill player-health" id="player-health-bar" style="width: 100%"></div>
                                </div>
                            </div>
                            <div class="stat-grid" id="player-combat-stats">
                                <div class="stat-item">
                                    <span class="stat-label">STR</span>
                                    <span class="stat-value" id="player-str">0</span>
                                </div>
                                <div class="stat-item">
                                    <span class="stat-label">DEX</span>
                                    <span class="stat-value" id="player-dex">0</span>
                                </div>
                                <div class="stat-item">
                                    <span class="stat-label">LCK</span>
                                    <span class="stat-value" id="player-luck">0</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="combat-actions-panel">
                    <button class="combat-btn combat-btn-fight" id="fight-btn">
                        <span class="btn-icon">‚öîÔ∏è</span>
                        <span class="btn-text">Fight</span>
                    </button>
                    <button class="combat-btn combat-btn-flee" id="flee-btn">
                        <span class="btn-icon">üèÉ</span>
                        <span class="btn-text">Flee</span>
                    </button>
                </div>
                
                <div class="combat-message" id="combat-message"></div>
            </div>
        </div>
    </div>

        <!-- Save Slots Modal -->
        <div id="save-slots-modal" class="modal">
            <div class="modal-content save-slots-modal-content">
                <div class="modal-header">
                    <h2>üíæ Save Slots</h2>
                    <button class="modal-close" onclick="saveManager.hideModal()">√ó</button>
                </div>
                <div id="save-slots-container" class="save-slots-container">
                    <!-- Save slots will be rendered here -->
                </div>
            </div>
        </div>

        <script src="map-renderer.js"></script>
        <script src="save-manager.js"></script>
        <script src="app.js"></script>
    </body>
</html>

